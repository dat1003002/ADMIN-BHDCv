@model X.PagedList.IPagedList<AspnetCoreMvcFull.ModelDTO.Product.LaboratoryEquipmentF1DTO>
   @using X.PagedList.Mvc.Core
   @using X.PagedList

   @{
       ViewData["Title"] = "Lab Equit F#1 Thẻ lý thiết bị";
   }

   <div class="d-flex justify-content-between">
       <a asp-controller="LaboratoryEquipmentF1" asp-action="CreateLaboratoryEquipmentF1" style="background: #428BCA; border: 1px solid #428BCA; color: white; padding: 6px; font-size: 14px; border-radius: 5px; text-decoration: none;">
           Thêm Mới
       </a>
       <form asp-controller="LaboratoryEquipmentF1" asp-action="SearchLaboratoryEquipmentF1" method="get" style="display: flex; align-items: center; margin-right: 20px;">
           <div style="display: inline-flex; border: 1px solid #ccc; border-radius: 2px; overflow: hidden;">
               <input type="hidden" name="page" value="@Model.PageNumber" />
               <input type="text" name="name" placeholder="Nhập tên hướng dẫn để tìm kiếm" style="border: none; padding: 5px 8px; font-size: 14px; width: 250px; height: 30px; outline: none;" required value="@TempData["SearchTerm"]" />
               <button type="submit" style="padding: 5px 12px; background-color: #428BCA; color: white; border: none; cursor: pointer; font-size: 14px; height: 30px; outline: none;">
                   Tìm kiếm
               </button>
           </div>
       </form>
   </div>

   <div class="container mt-4">
    <div class="row">
        @foreach (var product in Model)
        {
            <div class="col-12 col-sm-6 col-md-4 mb-4">
                <div class="card text-center custom-card" style="border: 2px solid #a1a3a5; display: flex; flex-direction: column;">
                    <div class="image-container">
                        <img class="card-img-top mx-auto custom-image" src="@Url.Content("~/images/" + product.image)" alt="Card image cap">
                        <div class="button-container">
                            <a asp-controller="ProductQC" asp-action="EditLaboratoryEquipmentF1" asp-route-id="@product.ProductId"
                               style="background:#428BCA; border:#428BCA solid 1px; color:white; padding:2px; font-size:9px; border-radius:5px; text-decoration: none;">
                                <i class='bx bx-edit'></i>
                            </a>
                            <button type="button" onclick="deleteProduct(@product.ProductId)"
                                    style="margin: 0px; padding:3px; background: #B74635; color: white; border: #B74635; border-radius: 4px;">
                                <i class="bx bx-trash-alt"></i>
                            </button>
                        </div>
                    </div>
                    <div class="card-body-title" data-bs-toggle="modal" data-bs-target="#modalScrollable"
                         onclick="loadProductQC(@product.ProductId)" style="margin-top: auto; cursor: pointer;">
                        <p class="custom-title">@product.name</p>
                    </div>
                </div>
            </div>
        }
    </div>
    <!-- Hiển thị phân trang -->
    <div class="pagination">
        @if (Model.PageCount > 1)
        {
            if (Model.HasPreviousPage)
            {
                <a href="@Url.Action("ListLaboratoryEquipmentF1", new { page = Model.PageNumber - 1, name = ViewData["SearchTerm"] })">«</a>
            }
            @for (int i = 1; i <= Model.PageCount; i++)
            {
                if (i == Model.PageNumber)
                {
                    <a href="#" class="active">@i</a>
                }
                else
                {
                    <a href="@Url.Action("ListLaboratoryEquipmentF1", new { page = i, name = ViewData["SearchTerm"] })">@i</a>
                }
            }
            if (Model.HasNextPage)
            {
                <a href="@Url.Action("ListLaboratoryEquipmentF1", new { page = Model.PageNumber + 1, name = ViewData["SearchTerm"] })">»</a>
            }
        }
    </div>
</div>

   <script>
       function deleteProduct(productId) {
           if (confirm("Bạn có chắc chắn muốn xóa hướng dẫn này không?")) {
               $.ajax({
                   url: '@Url.Action("DeleteLaboratoryEquipmentF1", "LaboratoryEquipmentF1")',
                   type: 'POST',
                   data: { productId: productId },
                   success: function (result) {
                       if (result.success) {
                           alert(result.message);
                           location.reload();
                       } else {
                           alert("Có lỗi xảy ra: " + result.message);
                       }
                   },
                   error: function (xhr, status, error) {
                       alert("Có lỗi xảy ra: " + xhr.responseText);
                   }
               });
           }
       }

       function showProductDetails(productId) {
           $.ajax({
               url: '@Url.Action("ShowLaboratoryEquipmentF1", "LaboratoryEquipmentF1")',
               type: 'GET',
               data: { id: productId },
               success: function (data) {
                   $('#modalBody').html(data);
                   $('#modalScrollable').modal('show');
               },
               error: function (xhr, status, error) {
                   console.error(xhr);
                   alert('Có lỗi xảy ra khi tải dữ liệu hướng dẫn.');
               }
           });
       }
   </script>
